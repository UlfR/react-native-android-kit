package fr.aybadb.rnak.components;

import android.graphics.Color;
import android.support.design.widget.AppBarLayout;
import android.support.design.widget.CoordinatorLayout;
import android.support.v4.widget.NestedScrollView;
import android.support.v7.widget.Toolbar;
import com.facebook.react.uimanager.ThemedReactContext;
import com.facebook.react.uimanager.ViewGroupManager;
import com.facebook.react.views.text.ReactTextView;

import static android.support.design.widget.AppBarLayout.LayoutParams.SCROLL_FLAG_ENTER_ALWAYS;
import static android.support.design.widget.AppBarLayout.LayoutParams.SCROLL_FLAG_SCROLL;
import static android.support.design.widget.AppBarLayout.LayoutParams.SCROLL_FLAG_SNAP;

public class RCTCoordinatorLayout extends ViewGroupManager<CoordinatorLayout> {
	private final static String REACT_CLASS = "RNAKCoordinatorLayout";

	@Override
	public String getName() {
		return REACT_CLASS;
	}

	@Override
	protected CoordinatorLayout createViewInstance(ThemedReactContext reactContext) {
		// cf. xml http://www.feelzdroid.com/2015/07/android-appbarlayout-scrolling-example.html
		CoordinatorLayout coordinatorLayout = new CoordinatorLayout(reactContext);
		CoordinatorLayout.LayoutParams coordinatorLayoutParams = new CoordinatorLayout.LayoutParams(CoordinatorLayout.LayoutParams.MATCH_PARENT, CoordinatorLayout.LayoutParams.WRAP_CONTENT);

		AppBarLayout appBarLayout = new AppBarLayout(reactContext);
		appBarLayout.setLayoutParams(coordinatorLayoutParams);
		Toolbar toolbar = new Toolbar(reactContext);
		toolbar.setTitle("CoordinatorLayout");
		toolbar.setBackgroundColor(Color.parseColor("#FF8080"));
		AppBarLayout.LayoutParams appBarLayoutParams = new AppBarLayout.LayoutParams(AppBarLayout.LayoutParams.MATCH_PARENT, AppBarLayout.LayoutParams.WRAP_CONTENT);
		appBarLayoutParams.setScrollFlags(SCROLL_FLAG_ENTER_ALWAYS | SCROLL_FLAG_SCROLL | SCROLL_FLAG_SNAP);
		toolbar.setLayoutParams(appBarLayoutParams);
		appBarLayout.addView(toolbar);

		NestedScrollView nestedScrollView = new NestedScrollView(reactContext);
		CoordinatorLayout.LayoutParams coordinatorLayoutParams1 = new CoordinatorLayout.LayoutParams(CoordinatorLayout.LayoutParams.MATCH_PARENT, CoordinatorLayout.LayoutParams.WRAP_CONTENT);
		coordinatorLayoutParams1.setBehavior(new AppBarLayout.ScrollingViewBehavior());
		nestedScrollView.setLayoutParams(coordinatorLayoutParams1);
		nestedScrollView.setBackgroundColor(Color.GREEN);
		ReactTextView textView = new ReactTextView(reactContext);
		textView.setText("BEGIN 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT 111111111111111111111111TEXT END");
		textView.setLayoutParams(new NestedScrollView.LayoutParams(NestedScrollView.LayoutParams.MATCH_PARENT, NestedScrollView.LayoutParams.WRAP_CONTENT));
		textView.setBackgroundColor(Color.parseColor("#808080"));
		nestedScrollView.addView(textView);
		//CoordinatorLayout.LayoutParams coordinatorLayoutParams = (CoordinatorLayout.LayoutParams) nestedScrollView.getLayoutParams();
		//coordinatorLayoutParams.setBehavior(new AppBarLayout.ScrollingViewBehavior());
		//nestedScrollView.requestLayout();

		coordinatorLayout.addView(appBarLayout);
		coordinatorLayout.addView(nestedScrollView);

		/*
		// Programmatically ViewPager from a ViewGroupManager without jsx: Works perfectly yeahhhhh !!!
		ReactViewPagerManager test = new ReactViewPagerManager();
		// TODO: check JSResponderHandler jsResponderHandler and be sure that is good to set it to null !
		ReactViewPager reactViewPager = test.createView(reactContext, null);
		test.addView(reactViewPager, nestedScrollView1, 0);
		test.addView(reactViewPager, nestedScrollView2, 0);
		// behaviors.addView(reactViewPager, textView2, 0);
		reactViewPager.setCurrentItemFromJs(0, false);
		coordinatorLayout.addView(reactViewPager);
		*/

		//TODO send children from js and http://stackoverflow.com/questions/30954460/configure-coordinatorlayout-from-code
		for (int i = 0; i < coordinatorLayout.getChildCount(); i++) {
			System.out.println("CHILD AYOUB " + coordinatorLayout.getChildAt(i).toString());
		}

		return coordinatorLayout;
	}
}
